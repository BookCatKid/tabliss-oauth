<!DOCTYPE html>
<html>
<head>
    <title>Tabliss OAuth Redirect</title>
    <script>
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        function getHashParam(param) {
            const hashParams = new URLSearchParams(window.location.hash.substring(1));
            return hashParams.get(param);
        }

        window.onload = function() {
            // Get the state parameter which contains the extension's redirect URL
            const state = getQueryParam('state');
            const error = getQueryParam('error');
            
            if (error) {
                // Redirect back to extension with error
                window.location.href = decodeURIComponent(state) + '#error=' + error;
                return;
            }

            // Get the access token from the hash fragment
            const accessToken = getHashParam('access_token');
            const expiresIn = getHashParam('expires_in');
            
            if (accessToken && state) {
                // Redirect back to the extension with the token
                const redirectUrl = decodeURIComponent(state);
                window.location.href = `${redirectUrl}#access_token=${accessToken}&expires_in=${expiresIn}`;
            }
        };
    </script>
</head>
<body>
    <p>Redirecting...</p>
</body>
</html>
