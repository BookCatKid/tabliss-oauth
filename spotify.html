<!DOCTYPE html>
<html>
<head>
    <title>Spotify Auth Callback</title>
    <style>
        body {
            font-family: system-ui;
            max-width: 600px;
            margin: 2rem auto;
            padding: 0 1rem;
            text-align: center;
        }
        .token-box {
            background: #f5f5f5;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
        }
        textarea {
            width: 100%;
            padding: 0.5rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <div id="loading">
        <h2>Processing Spotify Authorization...</h2>
    </div>
    
    <div id="result" style="display:none">
        <h2>Authorization Successful!</h2>
        <p>Here's your access token:</p>
        <div class="token-box">
            <textarea id="token" rows="3" readonly></textarea>
            <button onclick="copyToken()">Copy Token</button>
        </div>
        <p>Copy this token and paste it into the Tabliss Spotify widget settings.</p>
        <p><small>Note: This token will expire in 1 hour.</small></p>
    </div>

    <script>
        function copyToken() {
            const textarea = document.getElementById('token');
            textarea.select();
            document.execCommand('copy');
            alert('Token copied to clipboard!');
        }

        // Extract token from URL hash
        if (window.location.hash) {
            const params = new URLSearchParams(window.location.hash.substring(1));
            const token = params.get('access_token');
            if (token) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('result').style.display = 'block';
                document.getElementById('token').value = token;
            }
        }
    </script>
</body>
</html>
